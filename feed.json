{
	"version": "https://jsonfeed.org/version/1",
	"title": "Steven Pate",
	"icon": "https://micro.blog/stevenpate/avatar.jpg",
	"home_page_url": "https://stevenpate.micro.blog/",
	"feed_url": "https://stevenpate.micro.blog/feed.json",
	"items": [
		
			{
				"id": "http://stevenpate.micro.blog/2022/10/13/making-the-libraryjson.html",
				"title": "Making the library.json file more useful",
				"content_html": "<p>I’ve had something sitting on the todo list for a long time: make the <a href=\"https://tomcritchlow.com/2020/04/15/library-json/\" title=\"Tom Critchlow's discussion of library.json\">library.json</a> file that bookshelves.dev a bit better by providing a full image path to the locally cached cover image for each book, as opposed to just dumping the source url for the image.</p>\n\n<p><a href=\"https://bookshelves..dev/library.json\" title=\"bookshelves.dev library.json\">The site’s library.json</a> output is generated by a nunjucks template page, which loops through all the books identified on the site and displays each one using the “book” <a href=\"https://www.11ty.dev/docs/shortcodes/\" title=\"Eleventy shortcode documentation\">shortcode</a>, which can take an ISBN and optionally a layout. Here, we pass the JSON layout.</p>\n\n<pre><code>---\npermalink: '/library.json'\n---\n{\n  &quot;name&quot;: &quot;&amp;#123;&amp;#123; site.title }}&quot;,\n  &quot;url&quot;: &quot;&amp;#123;&amp;#123; site.url }}&quot;,\n  &quot;bio&quot;: &quot;&amp;#123;&amp;#123; site.description }}&quot;,\n  &quot;lists&quot;: [\n  {%- for item in booksOnShelves.shelves %}\n    {\n      &quot;title&quot;: &quot;&amp;#123;&amp;#123; item.shelfTitle }}&quot;,\n      &quot;shelfID&quot;: &quot;&amp;#123;&amp;#123; item.shelfID }}&quot;,\n      &quot;url&quot;: &quot;&amp;#123;&amp;#123; site.url }}/&amp;#123;&amp;#123; item.shelfID }}&quot;,\n      &quot;books&quot;: [\n        {%- for ISBN in item.shelfItems %}\n        { \n          {% book ISBN, 'json' %}\n        }{% if not loop.last %},{% endif %}\n        {%- endfor %}\n      ]\n    }{% if not loop.last %},{% endif %}\n  {%- endfor %}\n  ]\n}\n</code></pre>\n\n<p>That book shortcode script passes some details to the layout to, and what it was passing was the path to the source of the image. This could be a local image or (more likely) a URL to an image on Amazon, identified by the build script using the ISBN. But on the site we don’t just use that URL, we use <a href=\"https://www.11ty.dev/docs/plugins/image/\" title=\"Eleventy Image plugin documentation\">the image plugin</a> to fetch, cache and create responsive markup for that image. That image plugin code is in a different script, so I modified <em>that</em> to return not just that resource, but also the path to the cached image.</p>\n\n<pre><code>    const html = `&lt;picture&gt;\n    ${Object.values(metadata)\n        .map((imageFormat) =&gt; {\n            return `  &lt;source type=&quot;${\n                imageFormat[0].sourceType\n            }&quot; srcset=&quot;${imageFormat\n                .map((entry) =&gt; entry.srcset)\n                .join(&quot;, &quot;)}&quot; sizes=&quot;${sizes}&quot;&gt;`;\n        })\n        .join(&quot;\\n&quot;)}\n      &lt;img\n        src=&quot;${lowsrc.url}&quot;\n        alt=&quot;${alt}&quot;\n        class=&quot;${cls}&quot;\n        loading=&quot;lazy&quot;\n        decoding=&quot;async&quot;&gt;\n    &lt;/picture&gt;`;\n\n    return { html, highsrc, lowsrc };\n</code></pre>\n\n<p>After updating the cacheImage script, I updated all references to it. Now, when build the site, the library.json should have absolute paths to my cached resource, and not the scraped URL of the image I used.</p>\n\n<p>Along the way I noticed that shareLibrary.njk was using the booksOnShelves.json directly, and not filtering out anything whose visibility is not set to &ldquo;true&rdquo;. I could have either filtered that in the nunjucks conditional on that generating page, or refactored it to use the booksOnShelf collection in eleventy, where the &ldquo;hidden&rdquo; books have already been filtered out. For now, I&rsquo;ve done the former, which is easier. But I&rsquo;m not sure where I would land if I thought about that a bit more deeply.</p>\n\n<p>Anyway, this was satisfyingly straightforward. May it serve as a reminder that doing the less exciting items on the todo list can feel really good. Sometimes I only want to work on the daunting new epics and deny myself the pleasure of shipping even a small piece of code.</p>\n",
				"content_text": "I’ve had something sitting on the todo list for a long time: make the [library.json](https://tomcritchlow.com/2020/04/15/library-json/ \"Tom Critchlow's discussion of library.json\") file that bookshelves.dev a bit better by providing a full image path to the locally cached cover image for each book, as opposed to just dumping the source url for the image. \n\n[The site’s library.json](https://bookshelves..dev/library.json \"bookshelves.dev library.json\") output is generated by a nunjucks template page, which loops through all the books identified on the site and displays each one using the “book” [shortcode](https://www.11ty.dev/docs/shortcodes/ \"Eleventy shortcode documentation\"), which can take an ISBN and optionally a layout. Here, we pass the JSON layout.\n\n\t---\n\tpermalink: '/library.json'\n\t---\n\t{\n\t  \"name\": \"&#123;&#123; site.title }}\",\n\t  \"url\": \"&#123;&#123; site.url }}\",\n\t  \"bio\": \"&#123;&#123; site.description }}\",\n\t  \"lists\": [\n\t  {%- for item in booksOnShelves.shelves %}\n\t    {\n\t      \"title\": \"&#123;&#123; item.shelfTitle }}\",\n\t      \"shelfID\": \"&#123;&#123; item.shelfID }}\",\n\t      \"url\": \"&#123;&#123; site.url }}/&#123;&#123; item.shelfID }}\",\n\t      \"books\": [\n\t        {%- for ISBN in item.shelfItems %}\n\t        { \n\t          {% book ISBN, 'json' %}\n\t        }{% if not loop.last %},{% endif %}\n\t        {%- endfor %}\n\t      ]\n\t    }{% if not loop.last %},{% endif %}\n\t  {%- endfor %}\n\t  ]\n\t}\n\nThat book shortcode script passes some details to the layout to, and what it was passing was the path to the source of the image. This could be a local image or (more likely) a URL to an image on Amazon, identified by the build script using the ISBN. But on the site we don’t just use that URL, we use [the image plugin](https://www.11ty.dev/docs/plugins/image/ \"Eleventy Image plugin documentation\") to fetch, cache and create responsive markup for that image. That image plugin code is in a different script, so I modified _that_ to return not just that resource, but also the path to the cached image. \n\n\t    const html = `<picture>\n\t    ${Object.values(metadata)\n\t        .map((imageFormat) => {\n\t            return `  <source type=\"${\n\t                imageFormat[0].sourceType\n\t            }\" srcset=\"${imageFormat\n\t                .map((entry) => entry.srcset)\n\t                .join(\", \")}\" sizes=\"${sizes}\">`;\n\t        })\n\t        .join(\"\\n\")}\n\t      <img\n\t        src=\"${lowsrc.url}\"\n\t        alt=\"${alt}\"\n\t        class=\"${cls}\"\n\t        loading=\"lazy\"\n\t        decoding=\"async\">\n\t    </picture>`;\n\t\n\t    return { html, highsrc, lowsrc };\n\nAfter updating the cacheImage script, I updated all references to it. Now, when build the site, the library.json should have absolute paths to my cached resource, and not the scraped URL of the image I used.\n\nAlong the way I noticed that shareLibrary.njk was using the booksOnShelves.json directly, and not filtering out anything whose visibility is not set to \"true\". I could have either filtered that in the nunjucks conditional on that generating page, or refactored it to use the booksOnShelf collection in eleventy, where the \"hidden\" books have already been filtered out. For now, I've done the former, which is easier. But I'm not sure where I would land if I thought about that a bit more deeply.\n\nAnyway, this was satisfyingly straightforward. May it serve as a reminder that doing the less exciting items on the todo list can feel really good. Sometimes I only want to work on the daunting new epics and deny myself the pleasure of shipping even a small piece of code.\n\n\n",
				"date_published": "2022-10-13T10:37:23-07:00",
				"url": "https://stevenpate.micro.blog/2022/10/13/making-the-libraryjson.html",
				"tags": ["bookshelves"]
			},
			{
				"id": "http://stevenpate.micro.blog/2022/10/13/adding-blog-posts.html",
				"title": "Adding a blog feed",
				"content_html": "<p>I added blog posts to the <a href=\"https://bookshelves.dev\">bookshelves.dev</a> site, imported from my micro.blog. The idea is that I will start using this to document bits of work that I&rsquo;m able to finish, or to talk about what is blocking me.</p>\n\n<p>I&rsquo;m not sure why I like the idea of using the <a href=\"https://micro.blog/\">micro.blog</a> front end, other than it feels <a href=\"https://indieweb.org/Micropub\">indiewebby</a> and dead simple. And it was sure simple to find the automatically generated public json feed. It was almost as simple to import the data from that feed into 11ty as <a href=\"https://www.11ty.dev/docs/data-global/\">global data</a>.</p>\n\n<p>Because I theoretically might use this platform for posts that don&rsquo;t have anything to do with the bookshelves.dev project, I filtered out items that don&rsquo;t have a &ldquo;bookshelves&rdquo; tag when creating the data collection in 11ty and using the <a href=\"https://www.11ty.dev/docs/pagination/\">pagination</a> functionality to build individual posts.</p>\n\n<p>The only thing left to do was to create a <a href=\"https://docs.netlify.com/configure-builds/build-hooks/\">Netlify build hook</a> to trigger a deployment when a new blog post is published, which is rather clumsily accomplished via <a href=\"https://zapier.com/\">Zapier</a> and the micro.blog&rsquo;s RSS feed.</p>\n\n<p>Is this overly complicated? Almost certainly. But It does exactly what I want it to do. And I&rsquo;m happy to mark this one as done.</p>\n",
				"content_text": "I added blog posts to the [bookshelves.dev](https://bookshelves.dev) site, imported from my micro.blog. The idea is that I will start using this to document bits of work that I'm able to finish, or to talk about what is blocking me.\n\nI'm not sure why I like the idea of using the [micro.blog](https://micro.blog/) front end, other than it feels [indiewebby](https://indieweb.org/Micropub) and dead simple. And it was sure simple to find the automatically generated public json feed. It was almost as simple to import the data from that feed into 11ty as [global data](https://www.11ty.dev/docs/data-global/). \n\nBecause I theoretically might use this platform for posts that don't have anything to do with the bookshelves.dev project, I filtered out items that don't have a \"bookshelves\" tag when creating the data collection in 11ty and using the [pagination](https://www.11ty.dev/docs/pagination/) functionality to build individual posts. \n\nThe only thing left to do was to create a [Netlify build hook](https://docs.netlify.com/configure-builds/build-hooks/) to trigger a deployment when a new blog post is published, which is rather clumsily accomplished via [Zapier](https://zapier.com/) and the micro.blog's RSS feed.\n\nIs this overly complicated? Almost certainly. But It does exactly what I want it to do. And I'm happy to mark this one as done.\n",
				"date_published": "2022-10-13T00:20:31-07:00",
				"url": "https://stevenpate.micro.blog/2022/10/13/adding-blog-posts.html",
				"tags": ["bookshelves","web development"]
			},
			{
				"id": "http://stevenpate.micro.blog/2022/06/20/tonight-i-tweaked.html",
				"title": "CSS is hard to tackle piecemeal",
				"content_html": "<p>Tonight I tweaked the markup and fiddled with the tailwind classes  on <a href=\"https://bookshelves.dev\">bookshelves.dev</a> to get the featured items on the homepage to bother me less.</p>\n\n<p>Since they look like cards, I wanted the whole thing to be clickable. But wrapping the existing markup in an anchor tag of course messed with the colors and text-decoration, so I had to track down how to extend the tailwind.config. Then I wanted some subtle hover animation and finally feel better about that. I liked it enough to implement it for the card component layouts of the shelf and book shortcodes across the site. Along the way, I also eliminated a couple of things that were wonky at intermediate breakpoints.</p>\n\n<p>Overall I still feel really unhappy with the clunkiness of the visual design and the haphazard feeling of the markup and the chaos of tailwind classes. But it hurts me a little bit less.</p>\n\n<p>I sure wish I had time to go deep on the css from scratch. But there are other things I really want to be doing on the site right now. Fiddling with these little things is a luxury I don&rsquo;t often afford myself lately.</p>\n",
				"content_text": "Tonight I tweaked the markup and fiddled with the tailwind classes  on [bookshelves.dev](https://bookshelves.dev) to get the featured items on the homepage to bother me less. \n\nSince they look like cards, I wanted the whole thing to be clickable. But wrapping the existing markup in an anchor tag of course messed with the colors and text-decoration, so I had to track down how to extend the tailwind.config. Then I wanted some subtle hover animation and finally feel better about that. I liked it enough to implement it for the card component layouts of the shelf and book shortcodes across the site. Along the way, I also eliminated a couple of things that were wonky at intermediate breakpoints.\n\nOverall I still feel really unhappy with the clunkiness of the visual design and the haphazard feeling of the markup and the chaos of tailwind classes. But it hurts me a little bit less.\n\nI sure wish I had time to go deep on the css from scratch. But there are other things I really want to be doing on the site right now. Fiddling with these little things is a luxury I don't often afford myself lately.\n",
				"date_published": "2022-06-20T21:58:54-07:00",
				"url": "https://stevenpate.micro.blog/2022/06/20/tonight-i-tweaked.html",
				"tags": ["bookshelves","web development"]
			},
			{
				"id": "http://stevenpate.micro.blog/2021/11/16/005231.html",
				"title": "The Bookstore is My Mountain",
				"content_html": "<p><img src=\"https://stevenpate.micro.blog/uploads/2021/bf22d0a83f.jpg\" alt=\"\" /></p>\n",
				"content_text": "![](https://stevenpate.micro.blog/uploads/2021/bf22d0a83f.jpg)\n",
				"date_published": "2021-11-16T01:52:00-07:00",
				"url": "https://stevenpate.micro.blog/2021/11/16/005231.html"
			}
	]
}
